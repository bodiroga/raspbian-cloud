## Check filesystem permissions, uid, gid, space and inode usage. Other services,
## such as databases, may depend on this resource and an automatically graceful
## stop may be cascaded to them before the filesystem will become full and data
## lost.
#
check filesystem volume-datafs with path /media/volume-data
    if space usage > 90% for 5 times within 15 cycles then alert
    if inode usage > 95% then alert
    if changed fsflags then alert
    group system

check program volume-data-raid with path "/bin/btrfs-check -m /media/volume-data"
    if status != 0 then alert
    if status != 0 for 5 cycles then exec "/bin/btrfs-balance-raid /media/volume-data volume-data"
    if status != 0 for 5 cycles then unmonitor
    depends on volume-datafs
    group system

